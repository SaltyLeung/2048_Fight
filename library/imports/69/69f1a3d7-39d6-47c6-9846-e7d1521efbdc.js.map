{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\Game.js"],"names":["Game","cc","Class","extends","Component","properties","gameOver","win","slideCount","isP2","destroySpeed","timeOut","vsController","default","type","require","squarePrefab","Prefab","positionList","Node","eatableList","Boolean","moveableList","stepCount","onLoad","i","number","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","start","randomCreate","update","dt","emptyPos","Array","push","p1Win","p2Win","index","Math","floor","random","length","newValue","newSquare","instantiate","setPosition","getPosition","getComponent","gameScript","node","addChild","Animation","play","console","log","checkAlive","moveDown","hasBeenMove","j","hasMerge","targetIndex","isMerge","k","toDestroyed","tempTarget","temp","move","tempList","moveUp","moveLeft","moveRight","event","keyCode","KEY","s","scheduleOnce","w","d","a","onSlide","direction","undefined","destroyIndex","destroy","module","exports"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\n\r\nvar Game = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        gameOver: false,\r\n        win:false,\r\n        slideCount:-1,\r\n        isP2: false,\r\n        destroySpeed: 2,\r\n        //fadeSpeed: 0.4,\r\n        timeOut : true,\r\n       \r\n        vsController: {\r\n            default: null,\r\n            type: require(\"VSController\")\r\n        },\r\n        squarePrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        positionList: {   //不动，最下面一行为0 1 2 3 倒数第二行为 4 5 6 7 以此类推  具有子属性number\r\n            default: [],\r\n            type:[cc.Node]\r\n        },\r\n        eatableList: {  //该节点位置是否可吞\r\n            default: [],\r\n            type:[cc.Boolean]\r\n        },\r\n        moveableList: {   //管理可移动方框\r\n            default: [],\r\n            type:[cc.Node]\r\n        },stepCount:0\r\n\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        for(var i = 0; i < 16; ++i) {\r\n            this.positionList[i].number = 0;\r\n            this.moveableList[i] = null;\r\n            this.eatableList[i] = false;\r\n        }\r\n        \r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        \r\n    },\r\n\r\n    start () {\r\n        this.randomCreate();\r\n        \r\n        //console.log(\"aaaaa\");\r\n    },\r\n    update(dt) {\r\n        //if(this.slideCount >= 6) {this.slideCount = 0; this.vsController.switchSide();} \r\n    },\r\n\r\n    randomCreate() {\r\n        if(this.gameOver == true) return;\r\n        //this.slideCount += 1;\r\n        //找随机空位\r\n        var emptyPos = new Array();\r\n        for(var i = 0; i < 16; ++i) { \r\n            if(this.positionList[i].number == 0) emptyPos.push(i); \r\n            if((this.positionList[i].number >= 2048) && (this.isP2 == false)) { this.vsController.p1Win(); return; }\r\n            else if((this.positionList[i].number >= 2048) && (this.isP2 == true)) { this.vsController.p2Win(); return; }\r\n        }\r\n       \r\n        var index = Math.floor(Math.random() * emptyPos.length);\r\n        \r\n        //随机生成2或4\r\n        var newValue = (1 + Math.floor(Math.random() * 2)) * 2;\r\n\r\n        var newSquare = cc.instantiate(this.squarePrefab);\r\n        //console.log(newSquare);\r\n        newSquare.setPosition(this.positionList[emptyPos[index]].getPosition());\r\n\r\n        newSquare.getComponent(require(\"Square\")).number = newValue;\r\n        newSquare.getComponent(require(\"Square\")).gameScript = this;\r\n        //newSquare.setGlobalZOrder(1000);\r\n        this.node.addChild(newSquare);\r\n        newSquare.getComponent(cc.Animation).play(\"2048Show\");\r\n\r\n        this.positionList[emptyPos[index]].number = newValue;\r\n        this.moveableList[emptyPos[index]] = newSquare;\r\n        console.log(\"----------\");\r\n        console.log(this.gameOver);\r\n        if(emptyPos.length == 1) {if(!(this.checkAlive())) {this.gameOver = true; console.log(\"GameOver\");}else console.log(\"Game Continue\");}\r\n        //console.log(emptyPos[index]);\r\n        //for(var i = 0; i < 16; ++i) { if(this.moveableList[i]!=null) console.log(\"moveableNum\"+i+\": \"+this.moveableList[i].getPosition());}\r\n        //for(var i = 0; i < 16; ++i) {console.log(\"position\"+i+\": \"+this.positionList[i].number);}\r\n        \r\n    },\r\n    moveDown() {\r\n        var hasBeenMove = false;\r\n        /*for(var i = 0; i < 16; ++i) {\r\n            this.eatableList[i] = true;\r\n        }\r\n        for(var i = 4; i < 16; ++i) {\r\n            if(this.moveableList[i] != null) this.moveableList[i].down(i);\r\n        }*///标记已经合并的并且挪出空位\r\n        for(var i = 0; i < 4; ++i) {  //列\r\n            for(var j = i; j < 16; j += 4) {   //每列中每个\r\n                if(this.moveableList[j] == null)  continue;\r\n               // var hasHole = [false, false, false, false];\r\n                var hasMerge = [false, false, false, false];\r\n                var targetIndex = j;\r\n                var isMerge = false;\r\n                for(var k = j - 4; k >= 0; k -= 4) {    //计算目标\r\n                    if(this.positionList[k].number == 0) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k; \r\n                        //hasHole[Math.floor(j/4)] = true; \r\n                        //this.positionList[k].number = this.positionList[j].number; \r\n                        //this.positionList[j].number = 0;  \r\n                        continue; \r\n                    }\r\n                   // else if(hasHole[Math.floor(k/4)] == true) { targetIndex = k; hasHole[Math.floor(j/4)] = true; continue; }\r\n                    else if((this.positionList[k].number == this.positionList[j].number) && (hasMerge[Math.floor(k/4)] == false)) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k;  \r\n                       // hasHole[Math.floor(j/4)] = true; \r\n                        hasMerge[Math.floor(k/4)] = true; \r\n                        this.moveableList[j].getComponent(require(\"Square\")).toDestroyed = true;\r\n                        //this.moveableList[k].getComponent(require(\"Square\")).toDouble = true;\r\n                        isMerge = true;\r\n                        //this.positionList[j].number = 0;\r\n                        //this.positionList[k].number *= 2;\r\n                        break; \r\n                    }\r\n                    else break;   \r\n                }\r\n                //console.log(i+ \" \" +j +\"targetIndex \"+targetIndex);\r\n                this.moveableList[j].getComponent(require(\"Square\")).tempTarget = targetIndex;\r\n                var temp = this.positionList[j].number;\r\n                this.positionList[j].number = 0;\r\n                this.positionList[targetIndex].number = temp;\r\n                if(isMerge == true) this.positionList[targetIndex].number *= 2;\r\n            }\r\n        }\r\n\r\n        for(var i = 4; i < 16; ++i) {\r\n            if(this.moveableList[i] != null)  this.moveableList[i].getComponent(require(\"Square\")).move(this);   \r\n        }  //物理移动（逻辑上还没移动），移动后下标为source，target为目标\r\n        for(var i = 0; i < 16; ++i) {\r\n            if((this.moveableList[i] != null) && (this.moveableList[i].getComponent(require(\"Square\")).toDestroyed == true)) {  \r\n                this.moveableList[i].getComponent(cc.Animation).play(\"2048Fade\"); this.moveableList[i] = null; \r\n            }\r\n        }    //删除多余卡片 \r\n        \r\n        var tempList = new Array(); \r\n        for(var j = 0; j < 16; ++j) tempList[j] = this.moveableList[j]; \r\n        //for(var j = 0; j < 16; ++j)console.log(\"TempList\"+j+\" : \"+tempList[j]);\r\n        //for(var j = 0; j < 16; ++j)console.Log\r\n        for(var j = 0; j < 16; ++j) this.moveableList[j] = null; \r\n        for(var i = 0; i < 16; ++i) {\r\n            if(tempList[i] != null) {\r\n                //console.log(\"TYpe\"+typeof(tempList[i].getComponent(require(\"Square\")).tempTarget));\r\n                this.moveableList[tempList[i].getComponent(require(\"Square\")).tempTarget] = tempList[i];\r\n             }\r\n        }   //moveableList复位\r\n        //for(var j = 0; j < 16; ++j)console.log(\"mList(aftertemp)\"+j+\" : \"+this.moveableList[j]);\r\n        for(var i = 0; i < 16; ++i) {\r\n            /*if(this.moveableList[i] == null) this.positionList[i].number = 0;\r\n            else if(this.moveableList[i].getComponent(require(\"Square\")).toDouble == true) {\r\n                this.moveableList[i].getComponent(require(\"Square\")).number *= 2; \r\n                this.positionList[i].number = this.moveableList[i].getComponent(require(\"Square\")).number;\r\n                this.moveableList[i].getComponent(require(\"Square\")).toDouble = false;\r\n            }else  this.positionList[i].number = this.moveableList[i].getComponent(require(\"Square\")).number;*/\r\n            if(this.moveableList[i] != null) this.moveableList[i].getComponent(require(\"Square\")).number = this.positionList[i].number; \r\n        }   //维护positionList\r\n        return hasBeenMove;\r\n    },\r\n    /*onKeyDown (event) {\r\n        // set a flag when key pressed\r\n        if(this.timeOut == false) return;  //屏蔽输入\r\n        switch(event.keyCode) {\r\n            case cc.KEY.s:\r\n                if(this.moveDown() == false) return;\r\n                this.timeOut = false;\r\n                this.scheduleOnce(function() {this.timeOut = true;this.randomCreate();console.log(\"sca\");},0.5);\r\n                //for(var i = 0; i < 16; ++i) console.log(this.moveableList[i]);\r\n                break;\r\n        }\r\n    },*/\r\n    moveUp() {\r\n        var hasBeenMove = false;\r\n        for(var i = 12; i < 16; ++i) {  //列\r\n            for(var j = i; j >= 0; j -= 4) {   //每列中每个\r\n                if(this.moveableList[j] == null)  continue;\r\n                var hasMerge = [false, false, false, false];\r\n                var targetIndex = j;\r\n                var isMerge = false;\r\n                for(var k = j + 4; k < 16; k += 4) {    //计算目标\r\n                    if(this.positionList[k].number == 0) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k; \r\n                        continue; \r\n                    }\r\n                    else if((this.positionList[k].number == this.positionList[j].number) && (hasMerge[Math.floor(k/4)] == false)) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k;  \r\n                        hasMerge[Math.floor(k/4)] = true; \r\n                        this.moveableList[j].getComponent(require(\"Square\")).toDestroyed = true;\r\n                        isMerge = true;\r\n                        break; \r\n                    }\r\n                    else break;   \r\n                }\r\n                this.moveableList[j].getComponent(require(\"Square\")).tempTarget = targetIndex;\r\n                var temp = this.positionList[j].number;\r\n                this.positionList[j].number = 0;\r\n                this.positionList[targetIndex].number = temp;\r\n                if(isMerge == true) this.positionList[targetIndex].number *= 2;\r\n            }\r\n        }\r\n\r\n        for(var i = 0; i < 16; ++i) {\r\n            if(this.moveableList[i] != null)  this.moveableList[i].getComponent(require(\"Square\")).move(this);   \r\n        }  //物理移动（逻辑上还没移动），移动后下标为source，target为目标\r\n        for(var i = 0; i < 16; ++i) {\r\n            if((this.moveableList[i] != null) && (this.moveableList[i].getComponent(require(\"Square\")).toDestroyed == true))   {  \r\n                this.moveableList[i].getComponent(cc.Animation).play(\"2048Fade\"); \r\n                this.moveableList[i] = null;  \r\n            }\r\n        }    //删除多余卡片 \r\n        \r\n        var tempList = new Array(); \r\n        for(var j = 0; j < 16; ++j) tempList[j] = this.moveableList[j]; \r\n        for(var j = 0; j < 16; ++j) this.moveableList[j] = null; \r\n        for(var i = 0; i < 16; ++i) {\r\n            if(tempList[i]!=null) {\r\n                //console.log(\"TYpe\"+typeof(tempList[i].getComponent(require(\"Square\")).tempTarget));\r\n                this.moveableList[tempList[i].getComponent(require(\"Square\")).tempTarget] = tempList[i];\r\n           }\r\n        }   //moveableList复位\r\n        for(var i = 0; i < 16; ++i) {\r\n            if(this.moveableList[i] != null) this.moveableList[i].getComponent(require(\"Square\")).number = this.positionList[i].number; \r\n        }   //维护positionList\r\n        return hasBeenMove;\r\n    },\r\n    moveLeft() {\r\n        var hasBeenMove = false;\r\n        for(var i = 0; i <= 12 ; i += 4) {  //列\r\n            for(var j = i; j < i + 4; ++j) {   //每列中每个\r\n                if(this.moveableList[j] == null)  continue;\r\n                var hasMerge = [false, false, false, false];\r\n                var targetIndex = j;\r\n                var isMerge = false;\r\n                for(var k = j - 1; k >= i; --k) {    //计算目标\r\n                    if(this.positionList[k].number == 0) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k; \r\n                        continue; \r\n                    }\r\n                    else if((this.positionList[k].number == this.positionList[j].number) && (hasMerge[Math.floor(k/4)] == false)) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k;  \r\n                        hasMerge[Math.floor(k/4)] = true; \r\n                        this.moveableList[j].getComponent(require(\"Square\")).toDestroyed = true;\r\n                        isMerge = true;\r\n                        break; \r\n                    }\r\n                    else break;   \r\n                }\r\n                this.moveableList[j].getComponent(require(\"Square\")).tempTarget = targetIndex;\r\n                var temp = this.positionList[j].number;\r\n                this.positionList[j].number = 0;\r\n                this.positionList[targetIndex].number = temp;\r\n                if(isMerge == true) this.positionList[targetIndex].number *= 2;\r\n            }\r\n        }\r\n\r\n        for(var i = 0; i < 16; ++i) {\r\n            if(this.moveableList[i] != null)  this.moveableList[i].getComponent(require(\"Square\")).move(this);   \r\n        }  //物理移动（逻辑上还没移动），移动后下标为source，target为目标\r\n        for(var i = 0; i < 16; ++i) {\r\n            if((this.moveableList[i] != null) && (this.moveableList[i].getComponent(require(\"Square\")).toDestroyed == true)) {  \r\n                this.moveableList[i].getComponent(cc.Animation).play(\"2048Fade\"); \r\n                this.moveableList[i] = null; \r\n            }\r\n        }    //删除多余卡片 \r\n        \r\n        var tempList = new Array(); \r\n        for(var j = 0; j < 16; ++j) tempList[j] = this.moveableList[j]; \r\n        for(var j = 0; j < 16; ++j) this.moveableList[j] = null; \r\n        for(var i = 0; i < 16; ++i) {\r\n            if(tempList[i]!=null) {\r\n                //console.log(\"TYpe\"+typeof(tempList[i].getComponent(require(\"Square\")).tempTarget));\r\n                this.moveableList[tempList[i].getComponent(require(\"Square\")).tempTarget] = tempList[i]; \r\n        }\r\n        }   //moveableList复位\r\n        for(var i = 0; i < 16; ++i) {\r\n            if(this.moveableList[i] != null) this.moveableList[i].getComponent(require(\"Square\")).number = this.positionList[i].number; \r\n        }   //维护positionList\r\n        return hasBeenMove;\r\n    },\r\n    moveRight() {\r\n        var hasBeenMove = false;\r\n        for(var i = 3; i <= 15; i += 4) {  //列\r\n            for(var j = i; j > i - 4; --j) {   //每列中每个\r\n                if(this.moveableList[j] == null)  continue;\r\n                var hasMerge = [false, false, false, false];\r\n                var targetIndex = j;\r\n                var isMerge = false;\r\n                for(var k = j + 1; k <= i; ++k) {    //计算目标\r\n                    if(this.positionList[k].number == 0) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k; \r\n                        continue; \r\n                    }\r\n                    else if((this.positionList[k].number == this.positionList[j].number) && (hasMerge[Math.floor(k/4)] == false)) { \r\n                        hasBeenMove = true;\r\n                        targetIndex = k;  \r\n                        hasMerge[Math.floor(k/4)] = true; \r\n                        this.moveableList[j].getComponent(require(\"Square\")).toDestroyed = true;\r\n                        isMerge = true;\r\n                        break; \r\n                    }\r\n                    else break;   \r\n                }\r\n                this.moveableList[j].getComponent(require(\"Square\")).tempTarget = targetIndex;\r\n                var temp = this.positionList[j].number;\r\n                this.positionList[j].number = 0;\r\n                this.positionList[targetIndex].number = temp;\r\n                if(isMerge == true) this.positionList[targetIndex].number *= 2;\r\n            }\r\n        }\r\n\r\n        for(var i = 0; i < 16; ++i) {\r\n            if(this.moveableList[i] != null)  this.moveableList[i].getComponent(require(\"Square\")).move(this);   \r\n        }  //物理移动（逻辑上还没移动），移动后下标为source，target为目标\r\n        for(var i = 0; i < 16; ++i) {\r\n            if((this.moveableList[i] != null) && (this.moveableList[i].getComponent(require(\"Square\")).toDestroyed == true)) {  \r\n                this.moveableList[i].getComponent(cc.Animation).play(\"2048Fade\"); \r\n                this.moveableList[i] = null;\r\n             }\r\n        }    //删除多余卡片 \r\n        \r\n        var tempList = new Array(); \r\n        for(var j = 0; j < 16; ++j) tempList[j] = this.moveableList[j]; \r\n        for(var j = 0; j < 16; ++j) this.moveableList[j] = null; \r\n        for(var i = 0; i < 16; ++i) {\r\n            if(tempList[i]!=null) {\r\n                //console.log(\"TYpe\"+typeof(tempList[i].getComponent(require(\"Square\")).tempTarget));\r\n                this.moveableList[tempList[i].getComponent(require(\"Square\")).tempTarget] = tempList[i]; \r\n            }\r\n        }   //moveableList复位\r\n        for(var i = 0; i < 16; ++i) {\r\n            if(this.moveableList[i] != null) this.moveableList[i].getComponent(require(\"Square\")).number = this.positionList[i].number; \r\n        }   //维护positionList\r\n        return hasBeenMove;\r\n    },\r\n    onKeyDown (event) {\r\n        // set a flag when key pressed\r\n        if(this.timeOut == false) return;  //屏蔽输入\r\n        switch(event.keyCode) {\r\n            case cc.KEY.s:\r\n                if(this.moveDown() == false) return;\r\n                this.timeOut = false;this.stepCount += 1;\r\n                this.scheduleOnce(function() {this.timeOut = true;this.randomCreate();console.log(\"sca\");},0.3);\r\n                //for(var i = 0; i < 16; ++i) console.log(this.moveableList[i]);\r\n                break;\r\n            case cc.KEY.w:\r\n                if(this.moveUp() == false) return;\r\n                this.timeOut = false;this.stepCount += 1;\r\n                this.scheduleOnce(function() {this.timeOut = true;this.randomCreate();console.log(\"sca\");},0.3);\r\n                break;  \r\n            case cc.KEY.d:\r\n                if(this.moveRight() == false) return;\r\n                this.timeOut = false;this.stepCount += 1;\r\n                this.scheduleOnce(function() {this.timeOut = true;this.randomCreate();console.log(\"sca\");},0.3);\r\n                break;\r\n            case cc.KEY.a:\r\n                if(this.moveLeft() == false) return;\r\n                this.timeOut = false;this.stepCount += 1;\r\n                this.scheduleOnce(function() {this.timeOut = true;this.randomCreate();console.log(\"sca\");},0.3);\r\n                break;  \r\n            default:\r\n                break;  \r\n        }\r\n    },\r\n    onSlide (direction) {    //1下 2上 3右 4左\r\n        // set a flag when key pressed\r\n        if(this.timeOut == false) return false;  //屏蔽输入\r\n        switch(direction) {\r\n            case \"down\":\r\n                if(this.moveDown() == false) return false;\r\n                this.timeOut = false;this.stepCount += 1;\r\n                this.scheduleOnce(function() { this.timeOut = true;this.randomCreate();},0.3);\r\n                //for(var i = 0; i < 16; ++i) console.log(this.moveableList[i]);\r\n                break;\r\n            case \"up\":\r\n                if(this.moveUp() == false) return false;\r\n                this.timeOut = false;this.stepCount += 1;\r\n                this.scheduleOnce(function() { this.timeOut = true;this.randomCreate();},0.3);\r\n                break;  \r\n            case \"right\":\r\n                if(this.moveRight() == false) return false;\r\n                this.timeOut = false;this.stepCount += 1; \r\n                this.scheduleOnce(function() {this.timeOut = true; this.randomCreate();},0.3);\r\n                break;\r\n            case \"left\":\r\n                if(this.moveLeft() == false) return false;\r\n                this.timeOut = false;this.stepCount += 1; \r\n                this.scheduleOnce(function() {this.timeOut = true;this.randomCreate();},0.3);\r\n                break;  \r\n            default:\r\n                break;  \r\n        } return true;\r\n    },\r\n    checkAlive() {\r\n        //var isAlive = false;\r\n        for(var i = 0; i < 16; ++i) {\r\n            if((i % 4 == 3)) continue;\r\n            if((this.positionList[i+1] != undefined) && (this.positionList[i+1].number == this.positionList[i].number)) return true;\r\n            //if((this.positionList[i-1] != undefined) && (this.positionList[i-1].number == this.positionList[i].number)) return true;\r\n            //if((this.positionList[i-4] != undefined) && (this.positionList[i-4].number == this.positionList[i].number)) return true;\r\n            if((this.positionList[i+4] != undefined) && (this.positionList[i+4].number == this.positionList[i].number)) return true;\r\n        } \r\n        for(var i = 3; i <= 11; i+=4) if(this.positionList[i].number == this.positionList[i+4].number) return true;\r\n        return false;\r\n    },\r\n\r\n    destroyIndex(index) {\r\n        this.positionList[index].number = 0;\r\n        this.moveableList[index].destroy();\r\n        this.moveableList[index] = null;\r\n    }\r\n    /*eat(source, target, newNode) {\r\n        this.moveableList[target].destroy();\r\n        this.moveableList[target] = this.moveableList[source];\r\n        this.moveableList[source] = null;\r\n\r\n        this.eatableList[target] = false;\r\n\r\n        this.positionList[source].number = 0;\r\n        this.positionList[target].number *= 2;\r\n        \r\n    },*/\r\n\r\n    /*gameOver() {\r\n        \r\n    }*/\r\n\r\n    // update (dt) {},\r\n});\r\n\r\nmodule.exports = Game;\r\n"]}